@std;
@std.gen;

main /* lol, main!!!*/ = [[int/**/argc, int argv --> int, int]] {

	y => {z = 10; (- 500e-100 *80+10 - "\\lol !!!\'\"" )};

	retVal = [[int, int]];
	
	y ? { loop =>
			y.z ?
				{1,2 loop}
			:
				{3,4 loop}
		} : 5,6 -->;
	retVal -->;
	// okay, we're done now!
};

/* name resolution testing */

nameRes = [[]] {
	x = [[int z --> int]] {
		100 -->;
		@main.y;
		y -->;
	};
};

x=10e-1;

@nameRes.x.y;

/* end name resolution testing */

table = [[int numChopsticks]] {
	chopsticks = [[ int[numChopsticks] ]];
	getChopsticks = [[--> int\, int\]] {
		\chopsticks, \chopsticks -->;
	};
	returnChopsticks = [[int\ cs1, int\ cs2]] {
		\cs1 $ \cs2 ->chopsticks;
	};
};

philosopher = [[table\ t, int id]] {
	eat = [[int\ cs1, int\ cs2 --> int\, int\]] {
		"Philosopher " + id + " eating...\n" ->std.out;
		\cs1, \cs2 -->;
	};
	loopback => std.rand std.delay \t.getChopSticks eat ->t.returnChopsticks loopback;
};

numPhilosophers = 5;

t = [[table\]] <- numPhilosophers;
\\[[std.gen]] <- numPhilosophers [[philosopher]] <- {t, ..};

// EOF comment