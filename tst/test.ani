@std;
@std.gen;

main /* lol, main!!!*/ = [[int/**/argc, int argv --> int, int]] {

	x = { (- 500e-100 *80+10 - "\\lol !!!\'\"" ) lol.filter.X };

	retVal = {int, int};
	
	argc ? { loop =>
			argv ?
				{1,2}
			:
				{3,4}
		} : 5,6 -->;
	retVal -->;
	// okay, we're done now!
};

/* name resolution testing */

nameRes = {
	x = [[int y --> int]] {
		100 -->
	};
};

@nameRes.x.y;

/* end name resolution testing */

table = [[int numChopsticks]] {
	chopsticks = [[ int[numChopsticks] ]];
	getChopsticks = [[--> int\, int\]] {
		\chopsticks, \chopsticks -->;
	};
	returnChopsticks = [[int\ cs1, int\ cs2]] {
		\cs1 $ \cs2 ->chopsticks;
	};
};

philosopher = [[table\ t, int id]] {
	eat = [[int\ cs1, int\ cs2 --> int\, int\]] {
		"Philosopher " + id + " eating...\n" ->std.out;
		\cs1, \cs2 -->;
	};
	loopback => std.rand std.delay \t.getChopSticks eat ->t.returnChopsticks loopback;
};

t = [[ table\ ]] <- 5;
[[ philosopher[5] ]] <- {t, _};

// EOF comment